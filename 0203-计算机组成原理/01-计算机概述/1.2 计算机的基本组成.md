# 计算机的基本组成

## 前言

存储程序型计算机

EDVAC
- 1949年
- 第一台程序式计算机

## 冯诺依曼计算机

冯诺依曼计算机
- 计算器有五大部分组成
- 指令和数据以同等地位存于存储器，可按地址寻访
- 指令和数据用二进制表示
- 指令由操作码和地址码组成
- 具有存储程序
- 以运算器为中心

### 冯诺依曼计算机硬件结构
- 运算器(ALU)：算数运算逻辑运算
- 控制器(CU)：指挥程序的运行
- 存储器：存放数据和程序
    - 主存
    - 辅存
- 输入设备：将信息转换成机器能识别的形式
- 输出设备：将结果转换成人们熟悉的形式
## 计算机硬件框图

### 以运算器为中心的计算机硬件框图

![[20241128165046.svg]]

以运算器为中心的计算机硬件的缺点
- 运算器为中心，导致运算器成为系统瓶颈
- 不具有层次化特征，系统部件耦合度过高

### 以存储器为中心的计算机硬件框图

![[20241128174152.svg]]

### 现代计算机硬件框图
![[20241128184733.svg]]

![[20241128174552.svg]]

## 计算机的工作步骤

1. 判断能否使用计算来解决
2. 建立数学模型
3. 确定计算方法
4. 编制解题程序
	- 程序：运算的 ***全部步骤***
	- 指令：每 ***一个步骤***

> [!example]+ 以计算$ax^{2}+bx+c$为例
> 方式一
> - 取x 	至运算器中
> - 乘以x 	在运算器中
> - 乘以a 	在运算器中
> - 存ax^2 	在存储器中
> - 取b 	至运算器中
> - 乘以x 	在运算器中
> - 加ax^2 	在运算器中
> - 加c 	在运算器中
>
> 方式二
> - 取x   至运算器中
> - 乘以a 在运算器中 
> - 加b   在运算器中 
> - 乘以x 在运算器中 
> - 加c   在运算器中 

### 指令格式

以计算$ax^2+bx+c$为例的程序清单

| 主存单元地址     | 操作码    | 地址码          | 注释                      |
| ---------- | ------ | ------------ | ----------------------- |
| $(00)_{H}$ | 000001 | 00'0000'1000 | 取数$x$->`ACC`            |
| $(01)_{H}$ | 000100 | 00'0000'1001 | $\times a=ax$->`ACC`    |
| $(02)_{H}$ | 000011 | 00'0000'1010 | $+b=ax+b$->`ACC`        |
| $(03)_{H}$ | 000100 | 00'0000'1000 | $\times x=ax+b$->`ACC`  |
| $(04)_{H}$ | 000011 | 00'0000'1011 | $+c=ax^{2}+bx+c$->`ACC` |
| $(05)_{H}$ | 000010 | 00'0000'1100 | `ACC`->`M`              |
| $(06)_{H}$ | 000101 | 00'0000'1100 | 打印                      |
| $(07)_{H}$ | 000110 |              | 停机                      |
| $(08)_{H}$ | x      |              | 原始数据x                   |
| $(09)_{H}$ | a      |              | 原始数据a                   |
| $(0A)_{H}$ | b      |              | 原始数据b                   |
| $(0B)_{H}$ | c      |              | 原始数据c                   |
| $(0C)_{H}$ |        |              | 存放结果                    |

| 指令  | 格式             |
| --- | -------------- |
| 取数α | [α]->ACC       |
| 存数β | [ACC]->β       |
| 加γ  | [ACC]+[γ]->ACC |
| 乘δ  | [ACC]×[δ]->ACC |
| 打印θ | [θ]->打印设备      |
| 停机  |                |

>[!warning]+ 注：乘法时可能会因为超出位数溢出

## 计算机的基本组成
![[20241128191045.svg]]

### 存储器

![[20241128185941.svg]]

**存储器**：保存数据和指令，通过*按地址询访*的方式查找存储的数据
- **存储器地址寄存器(MAR、Memory Address Register)**：寄存操作数据地址，反应存储单元的个数
	- *存储单元个数*：$存储单元个数 = 2^{MAR位数}$
- **存储器数据寄存器(MDR、Memory Data Register)**：寄存操作数据，反应存储字长
	- *存储字长*：$存储字长 = MDR位数$
- **存储体(M)**：由存储单元组成，存储数据的主要结构
    - *存储单元*：由存储元件组成，用于存储一串二进制码，每个存储单元赋予一个地址
    - *存储字*：存储单元中二进制代码的组合
    - *存储字长*：存储单元中二进制代码的数量


### 运算器

![[20241128190406.svg]]


**运算器**：通过算逻运算单元完成运算
- 累加器类型运算器结构
	- 累加器(ACC、Accumulator)
	- 乘商寄存器(MQ、Multiplier-Quotient Register)
	- 通用寄存器(X)
	- 算逻运算单元(ALU、ArithmeticLogicUnit)

#### [加法](0203-计算机组成原理/06-计算机的运算方法/6.3%20定点运算.md#加减运算)

**加法**：`ACC`存放*被加数*与*和，*`X`存放**加数**
1. 被加数->`ACC`;
2. $[M]$->`X`;
3. $[ACC]+[X]$->`ACC`;

#### [减法](0203-计算机组成原理/06-计算机的运算方法/6.3%20定点运算.md.md#加减运算)

**减法**：`ACC`保存*被减数*与*差*，`X`保存*减数*
1. 被减数->`ACC`
2. $[M]$->`X`
3. $[ACC]-[X]$->`ACC`

#### [乘法](0203-计算机组成原理/06-计算机的运算方法/6.3%20定点运算.md.md#乘法运算)

**乘法**：`ACC`存放*乘积高位*与*乘数*，`MQ`存放*乘积低位*，`X`存放*被乘数*
1. 被乘数->`ACC`
2. $[M]$->`MQ`
3. $[ACC]$->`X`
4. $0$->`ACC`
5. $[X]×[MQ]$->`ACC|MQ`：`MQ`是运算的高位

#### [除法](0203-计算机组成原理/06-计算机的运算方法/6.3%20定点运算.md.md#除法运算)

**除法**：`ACC`存放*被除数*和*余数*，`MQ`存放*商*，`X`存放*除数*
1. 被除数->`ACC`;
2. $[M]$->`X`;
3. $[ACC]÷[X]$->`MQ|ACC`;//余数在`ACC`中

### 控制器

**控制器**：解释指令，保证指令按序执行
- 指令解析器(CU)：用于解析指令，并发出相应控制信号
- 指令地址寄存器PC：存放当前域执行指令的地址，具有计数功能$[pc]+1$->`pc`
- 指令寄存器(IR)：存发当前欲执行的指令
- 控制流程：取指令->分析指令->执行指令

## 主机完成一条指令的过程

### 取数指令

- 取指令
    1. `PC`将保存的指令地址发送给`MAR`
    2. `MAR`激活存储体地址
    3. 存储体将地址所保存的指令数据返回`MDR`
    4. 取`MDR`指令数据到IR中
- 分析指令
    1. 将`IR`中保存的数据中的操作码部分传递给`CU`
    2. 将`IR`中保存的数据中的地址码部分传递给`MAR`
- 执行指令
    1. `MAR`激活存储体对应地址码的数据，返回至`MDR`
    2. 将`MDR`中的数据传递给`ACC`

### 存数指令

- 取指令
    1. `PC`将保存的指令地址发送给`MAR`
    2. `MAR`获取存储体对应地址的数据
    3. 存储体将对应数据返回至`MDR`
    4. 取`MDR`指令至`IR`中
- 分析指令
    1. 将`IR`中保存的数据中的操作码部分传递给`CU`
    2. 将`IR`中保存的数据中的地址码部分传递给`MAR`
- 执行指令
    1. `ACC`将数据传递给`MDR`
    2. 将`IR`指令数据中的地址码部分的存储单元开辟出来
    3. 将`MDR`中的数据写入存储体开辟出来的位置

### 程序运行过程

以计算$ax^2+bx+c$举例

1. 将程序通过输入设备送至计算机
2. 程序首地址 -> `PC`
3. 启动程序运行
4. 取数a
	1. 取指令：`PC`->`MAR`->`M`->`MDR`->`IR`; $[PC]+1$ -> `PC`
	2. 分析指令：$[IR]_{OP}$ -> `CU`
		- $OP$：指令部分
	3. 执行指令：$[IR]_{AD}$ -> `MAR` -> `M` -> `MDR` -> `ACC`
		- $AD$：地址码部分
		- `MAR`/`MDR`：类似于接口寄存器
5. 乘以x
6. 加b
7. 乘以x
8. 加c
9. 打印结果
10. 停机

