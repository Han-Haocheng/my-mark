# 操作系统引导流程

## 引导过程概述

操作系统引导过程是计算机从开机到操作系统完全加载的一系列步骤
## 图表说明

![操作系统引导流程图](../../attachment/Pasted%20image%2020240806144333.png)

## 引导步骤

### 1. 激活CPU
- **操作**：CPU激活后，读取ROM中的boot程序。
- **执行**：指令寄存器指向BIOS的第一条指令，执行ROM中的引导程序。

### 2. 硬件自检
- **BIOS操作**：在内存起始位置构建中断向量表。
- **POST过程**：执行通电自检（POST），检查硬件故障。
	- **故障处理**：如有故障，主板发出蜂鸣声，启动中止。
	- **正常情况**：显示CPU、内存、硬盘等信息。

### 3. 加载启动设备
- **BIOS读取**：执行Boot Sequence，确定启动顺序。
- **启动顺序**：根据CMOS设置或用户交互，选择首位的存储设备。
- **加载引导扇区**：将引导扇区内容加载到内存，读取主引导记录。

### 4. 执行主引导记录(MBR)
- **MBR加载**：主引导记录包含硬盘分区表，区分活动和非活动分区。
	- **非引导盘处理**：若设备不可引导，检查下一设备。
	- **无启动设备**：若无可引导设备，系统死机。

### 5. 加载活动分区
- **识别分区**：MBR扫描分区表，识别活动分区。
- **加载分区**：将控制权交给活动分区。

### 6. 执行分区引导记录(PBR)
- **读取PBR**：读取活动分区的第一个扇区，即分区引导记录。
- **引导程序**：激活分区根目录下的操作系统引导程序。

### 7. 启动管理器加载
- **搜索管理器**：PBR搜索并加载启动管理器。
	- **Windows示例**：启动管理器位于`C:/Windows/Boot`。

### 8. 加载操作系统
- **执行初始化**：将操作系统的初始化程序加载到内存并执行。

## X86架构计算机启动

1. 开机时CPU处于实模式(寻址方式为 $CS\ll4+IP$)
2. $CS=0\times FFFF;IP=0\times0000$
3. 寻址ROM BIOS映射区($0\times FFFF0$)
4. 检查RAM，键盘、显示器、软硬磁盘
5. 将磁盘0磁道0扇区读入内存($0\times7C00$)
6. 设置 $CS=0\times 07C0;IP=0\times0000$
