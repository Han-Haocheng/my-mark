# 内存管理概念

- [内存相关知识](../../0203-计算机组成原理/04-存储器/4.2%20主存储器.md)
- [指令相关知识](../../0203-计算机组成原理/07-指令系统/7.1%20机器指令.md)
## 程序从编写到执行

![](../../attachment/svg/svg241101151521.svg)
##
**编译**：由编译程序将用户原代码编译成若干个目标模块，将高级语言*翻译成机器语言*

### 程序装入内存的方式

**装入(装载)**：由装入程序将装入模块装入内存

#### 绝对装入

**绝对装入**：编译程序按照程序将要放置在内存中的位置，生成*绝对地址*的目标程序，装入程序将程序和数据，按照装入模块中的地址装入内存
- *只适用于单道程序环境*

#### 静态重定位

**静态重定位（重定位装入）**：编译、链接后的装入模块地址从0开始。指令中使用的地址、数据存放的地址是相对于起始地址而言的逻辑地址。根据内存的当前情况，装入模块将装入到内存的适当位置。装入时对地址进行“*重定位*”，将逻辑地址变换为物理地址
- 作业装入内存时：必须分配其要求的全部内存空间，没有足够的内存，不能装入作业
- 作业进入内存后：在运行期间就不能移动，不能申请内存空间

#### 动态重定位

**动态重定位(动态运行时装入)**：编译、链接后的装入模块地址从0开始。装入程序把装入模块装入内存后，*地址转换推迟到程序真正执行期间*。装入内存后的地址是逻辑地址
- 需要*重定位寄存器*的支持
- 可将程序分配到不连续的存储区中
- 在程序运行前，只需装入它的部分代码即可投入运行
- 程序运行期间，根据需要动态申请分配内存
- 便于程序段的共享，可以向用户提供一个比存储空间大得多的地址空间
- *允许程序在内存中发生移动*

### 目标模块链接为装入模块

**链接**：链接程序将编辑后形成的目标模块，以及所需函数库连接在一起，形成一个完整的输入模块

#### 静态链接

**静态链接**：程序运行之前，将各目标模块及所需的库函数，连接成一个完整的装入模块

#### 装入时动态链接
**装入时动态链接**：将各目标模块装入内存时，边装入边链接的链接方式

#### 运行时动态链接

**运行时动态链接**：在程序执行中需要该目标模块时，才对它进行链接。其优点是便于修改和更新，便于实现对目标模块的共享

## 内存管理的功能
- 内存空间的分配与回收
- 对内存空间进行扩充
- 逻辑地址和物理地址的转换
- 内存保护

### 内存空间的分配与回收

### 对内存空间进行扩充

#### 覆盖技术

**覆盖技术**：解决程序大小超过物理内存总和的问题。将程序分为多个段(模块)。常用的段常驻内存，不长用的段在需要时调入内存。将内存划分一个*固定区*和若干个*覆盖区*
- 固定区：放置需要常驻内存的段，调入后不再调出，直到运行结束
- 覆盖区：放置不常用的段，需要时调入内存，不用时调出内存
- 必须由程序员声明覆盖结构，操作系统完成自动覆盖
- 缺点：对用户不透明，增加了用户编程的负担


#### 交换技术

**交换技术(对换技术)**：内存空间不足时，系统暂时将一些进程换出外存，将具备允许条件的进程换入内存。进程在内存和磁盘间动态调度

### 逻辑地址和物理地址的转换

**逻辑地址和物理地址的转换(地址重定位)**：[程序装入内存的方式](#程序装入内存的方式)

### 内存保护

1. 设置一对*上下限寄存器*进行越界检查
2. 采用*重定位寄存器*和*界地址寄存器*进行越界检查
	- 重定位寄存器(基地址寄存器)：存放进程起始物理地址
	- 界地址寄存器(限长寄存器)：存放进程最大逻辑地址




